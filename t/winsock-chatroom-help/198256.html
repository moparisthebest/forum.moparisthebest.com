<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/winsock-chatroom-help/198256 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 15:46:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Winsock ChatRoom Help - General Programming - moparisthebest.com</title>
    <meta name="description" content="I was working on a little ChatRoom cause I was bored but I seem to be having a problem when multiple clients connect it doesnt send the message to all of them">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="198256.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Winsock ChatRoom Help&#39;" href="198256.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/winsock-chatroom-help/198256" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/winsock-chatroom-help/198256" />
<meta property="og:title" content="Winsock ChatRoom Help" />
<meta name="twitter:title" content="Winsock ChatRoom Help" />
<meta property="og:description" content="I was working on a little ChatRoom cause I was bored but I seem to be having a problem when multiple clients connect it doesnt send the message to all of them" />
<meta name="twitter:description" content="I was working on a little ChatRoom cause I was bored but I seem to be having a problem when multiple clients connect it doesnt send the message to all of them" />
<meta property="article:published_time" content="2008-04-10T16:03:01+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="198256.html">Winsock ChatRoom Help</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Nashi.html'><span itemprop='name'>Nashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T16:03:01Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:42:49Z' class='post-time'>
              July 30, 2016,  9:42pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I was working on a little ChatRoom cause I was bored but I seem to be having a problem when multiple clients connect it doesnt send the message to all of them</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bakatool.html'><span itemprop='name'>bakatool</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T17:38:14Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:42:54Z' class='post-time'>
              July 30, 2016,  9:42pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i think the problem is in your connection request (receiver) is after accepting a connection from some user</p>
<p>for no reason it creates a new server and listens for connection.??</p>
<p>u dont wanna make a listener for every person that connects dunno how that works anyways anyone who disconnects sckClosed state is created into a listener and every new socket loaded is also made into a listener.</p>
<p>Private Sub Sockets_ConnectionRequest(Index As Integer, ByVal requestID As Long)<br>
On Error Resume Next<br>
Dim Ind As Integer<br>
Sockets(Index).Close<br>
Sockets(Index).Accept (requestID)<br>
<span class="bbcode-b">   For Ind = Sockets.LBound To Sockets.UBound<br>
If (Sockets(Ind).State = sckClosed) Then<br>
Sockets(Ind).Listen<br>
Exit Sub<br>
End If<br>
Next Ind<br>
Load Sockets(Sockets.UBound + 1)<br>
Sockets(Sockets.UBound).Listen</span><br>
End Sub</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Nashi.html'><span itemprop='name'>Nashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T18:23:47Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:42:57Z' class='post-time'>
              July 30, 2016,  9:42pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Wouldn’t it give me an error because the port would be in use?</p>
<p>I have it to Exit the Sub if that happens but even so It still seems not to work and just load a new one to listen</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bakatool.html'><span itemprop='name'>bakatool</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T18:39:57Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:42:59Z' class='post-time'>
              July 30, 2016,  9:42pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yah man it errors</p>
<p>On Error Resume Next</p>
<p>it just keeps going down the lines and doing random stuff if u remove all that black highlighted code everything should work</p>
<p>it would load a new one and listen because the connection is not closed in the loop</p>
<p>anyways its all useless no point in adding that highlighted code in there anyways right? you thought listen would refresh the socket or something so it could be used again well it doesn’t matter they refresh automatically after u do Socket(index).close</p>
<p>try to add a</p>
<p>Private Sub Sockets_Close(index as integer)<br>
msgbox index &amp; " has just disconencted."<br>
end sub</p>
<p>yah u got it nvm</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Nashi.html'><span itemprop='name'>Nashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T18:55:43Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:43:00Z' class='post-time'>
              July 30, 2016,  9:43pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I did that and yet it still has the problem I started with, When new clients Join it only sends the messages to the last one and I think it’s an infinite loop cause it does that message box a whole lot</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bakatool.html'><span itemprop='name'>bakatool</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T19:18:52Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:43:02Z' class='post-time'>
              July 30, 2016,  9:43pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>msgbox would be inside sockets_close everytime someone new connects it has closes connection to accept it. O yah another bug</p>
<p>Private Sub Form_Load()<br>
Sockets(Sockets.UBound).Listen<br>
End Sub</p>
<p>change that to Sockets(0).Listen</p>
<p>also try to change inside SendGlobalMessage  the Sockets.LBound  to 0</p>
<pre><code>Dim Ind As Integer
For Ind = Sockets.LBound To Sockets.UBound
    If (Sockets(Ind).State = sckConnected) Then
        Sockets(Ind).SendData (Msg)
    End If
Next Ind
</code></pre>
<p>maybe add a On error resume next on top it could error if socket isn’t loaded</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Nashi.html'><span itemprop='name'>Nashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-10T20:52:28Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:43:10Z' class='post-time'>
              July 30, 2016,  9:43pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Dunno how I got the looping error the first time, But It’s definately gone,<br>
But that still hasn’t fixed the big problem which is that it doesn’t send the data to connected clients.</p>
<p>BTW, Those are exactly the same</p>
<p>Uploaded newest version to first post</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bakatool.html'><span itemprop='name'>bakatool</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-11T00:31:32Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:43:33Z' class='post-time'>
              July 30, 2016,  9:43pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>here try this out its hard to see how to keep trace of all users connected or not without a array I attached it.</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Nashi.html'><span itemprop='name'>Nashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-04-11T03:40:51Z'>
            <time itemprop='dateModified' datetime='2016-07-30T21:44:15Z' class='post-time'>
              July 30, 2016,  9:44pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t get what you mean by Server Listener?<br>
Unless your trying to have one always listening and the others connecting to the requests</p>
<p>Either way It still doesn’t seem to send it to the clients o_o<br>
It could be a problem with the client program</p>
<p>Also I received an error when I closed your server =[</p>
      </div>

      <meta itemprop='headline' content='Winsock ChatRoom Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/winsock-chatroom-help/198256 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 15:46:43 GMT -->
</html>
