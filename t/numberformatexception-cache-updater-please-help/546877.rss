<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>NumberFormatException cache updater Please Help!</title>
    <link>https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877</link>
    <description>Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropbox&#39;s serve for some reason gives an error when uploading the text document in ANSI coding. I changed it to UTF-8 and now it works. (note the cacheversion.text is in UTF-8 coding) I dont know if that matters. But now when my cacheupdater loads the file i get a NumberFormatException error when trying to convert the string to an integer. The text document only has the characters 1.0 saved inside. I cannot understand why it wont work!

I get a 460 error when the document wont get hosted under ANSI coding. With UTF-8 coding it works fine on server just get the number format exception. 

Please help me and request code for my cachedownloader/client/whatever you need and I will post it! 
 
Your help is immensely appreciated!
photos: 

[url=https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png]https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png[/url]
[url=https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png]https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png[/url]
[url=https://www.dropbox.com/s/6je0do4po0grume/222.png]https://www.dropbox.com/s/6je0do4po0grume/222.png[/url]

[img]https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png[/img]
[img]https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png[/img]
[img]https://www.dropbox.com/s/6je0do4po0grume/222.png?dl=0[/img]

[b]UPDATE! - I put dl. in front of the file and now it downloads the .text file but since its not ANSI coding its getting a string like $;&#39;1.0 or something like that instead of just 1.0. Does anyone have a host site that works just like dropbox where you can make it DIRECTLY download without clicking a button because dropbox gives me a 460 error if the documents in ANSI coding? Which is default?[/b]

updatecache.java file - 

[code]import java.net.URL;
import java.net.URLConnection;
import java.util.zip.*;
import sign.signlink;
import java.io.*;
import javax.swing.JOptionPane;

public class UpdateCache implements Runnable {

        public static final String ZIP_URL = &quot;https://www.dropbox.com/s/hsnkfyohgofpbrv/------------.zip&quot;;
        public static final String VERSION_URL = &quot;https://www.dropbox.com/s/zoexsmc6ddgsa0j/cacheVersion.text&quot;;
        public static final String VERSION_FILE = sign.signlink.findcachedir()+&quot;cacheVersion.dat&quot;;
        private client client;
        client frame;
    public UpdateCache(client client) {
                this.client = client;
    }
                
    private void drawLoadingText(int amount, String text) {
                client.drawLoadingText(amount, text);
    }
        
        public double getCurrentVersion(){
                try {
                        BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(VERSION_FILE)));
                        return Double.parseDouble(br.readLine());
                } catch (Exception e) {
                        return 0.1;
                }
        }
        
        public double getNewestVersion(){
                try {
                        URL tmp = new URL(VERSION_URL);
                        BufferedReader br = new BufferedReader(new InputStreamReader(tmp.openStream()));
                        return Double.parseDouble(br.readLine());
                } catch (Exception e) {
                        handleException(e);
                        return -1;
                }
        }
        
        private void handleException(Exception e){
                StringBuilder strBuff = new StringBuilder();
                strBuff.append(&quot;Please Screenshot this message, and send it to an admin!\r\n\r\n&quot;);
        StringBuilder append = strBuff.append(e.getClass().getName()).append(&quot; \&quot;&quot;).append(e.getMessage()).append(&quot;\&quot;\r\n&quot;);
                for(StackTraceElement s : e.getStackTrace())
                        strBuff.append(s.toString()).append(&quot;\r\n&quot;);
                alert(&quot;Exception [&quot; + e.getClass().getSimpleName() + &quot;]&quot;,strBuff.toString(),true);
        }
        
        private void alert(String msg){
                alert(&quot;Message&quot;,msg,false);
        }
        
        private void alert(String title,String msg,boolean error){
                JOptionPane.showMessageDialog(null,
                           msg,
                           title,
                            (error ? JOptionPane.ERROR_MESSAGE : JOptionPane.PLAIN_MESSAGE));
        }
        
        @Override
        public void run() {
        drawLoadingText(0, &quot;Checking Versions&quot;);
                try{
                double newest = getNewestVersion();
                if(newest &gt; this.getCurrentVersion()){
                        int n = JOptionPane.showConfirmDialog(
                                    null,
                                    &quot;There is an update to version &quot; + newest + &quot;\n&quot; +
                                        &quot;Would you like to update?&quot;,
                                    &quot;Current version: &quot;+ getCurrentVersion(),
                                    JOptionPane.YES_NO_OPTION);
                        if(n == 0){
                                updateClient();
                                drawLoadingText(0, &quot;Cache has been updated, please restart the client!&quot;);
                                alert(&quot;Cache has been updated, please restart the client!&quot;);
                                OutputStream out = new FileOutputStream(VERSION_FILE);
                                out.write(String.valueOf(newest).getBytes());;
                                System.exit(0);
                        }else{
                                alert(&quot; Your client may not load correct &quot; +
                                getCurrentVersion());
                                //System.exit(0);
                        }
                }
                }catch(Exception e){
                        handleException(e);
                }
        }
        
        private void updateClient() {
                File clientZip = downloadClient();
                if(clientZip != null){
                unZip(clientZip);
                }
        }
        
        private void unZip(File clientZip) {
                try {
                        unZipFile(clientZip,new File(sign.signlink.findcachedir()));
                        clientZip.delete();
                } catch (IOException e) {
                        handleException(e);
                }
        }
        
        private void unZipFile(File zipFile,File outFile) throws IOException{
                ZipInputStream zin = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
                ZipEntry e;
                long max = 0;
                long curr = 0;
                while((e = zin.getNextEntry()) != null)
                        max += e.getSize();
                zin.close();
                ZipInputStream in = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
                while((e = in.getNextEntry()) != null){
                        if(e.isDirectory())
                                new File(outFile,e.getName()).mkdirs();
                        else{
                                FileOutputStream out = new FileOutputStream(new File(outFile,e.getName()));
                                byte[] b = new byte[1024];
                                int len;
                                while((len = in.read(b,0,b.length)) &gt; -1){
                                        curr += len;
                                                out.write(b, 0, len);
                                                setUnzipPercent((int)((curr * 100) / max));
                                }
                                out.flush();
                                out.close();
                        }
                }
        }

        public int percent = 0;
        
        public void setDownloadPercent(int amount){
                percent = amount;
                        drawLoadingText(amount, &quot;Downloading Cache&quot; + &quot; - &quot; + amount + &quot;%&quot;);
        }
        
        public int percent2 = 0;
        
        public void setUnzipPercent(int amount2){
                percent2 = amount2;
                        drawLoadingText(amount2, &quot;Extracting Cache&quot; + &quot; - &quot; + amount2 + &quot;%&quot;);
        }

        private File downloadClient(){
                File ret = new File(signlink.findcachedir()+&quot;cache.zip&quot;);
                try{
                OutputStream out = new FileOutputStream(ret);
                URLConnection conn = new URL(ZIP_URL).openConnection();
                InputStream in = conn.getInputStream();
                long max = conn.getContentLength();
                long curr = 0;
                byte[] b = new byte[1024];
                int len;
                while((len = in.read(b, 0, b.length)) &gt; -1){
                        out.write(b,0,len);
                        curr += len;
                        setDownloadPercent((int)((curr * 100) / max));
                }
                out.flush();
                out.close();
                in.close();
                return ret;
                }catch(Exception e){
                        handleException(e);
                                ret.delete();
                        return null;
                }
        }
}
[/code]</description>
    
    <lastBuildDate>Sat, 20 Sep 2014 19:16:40 +0000</lastBuildDate>
    <category>Game Development</category>
    <atom:link href="https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>NumberFormatException cache updater Please Help!</title>
        <dc:creator><![CDATA[@freaxx freaxx]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freaxx">@freaxx</a> wrote:</p>
          <blockquote>
              <p>Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropboxâ€™s serve for some reason gives an error when uploading the text document in ANSI coding. I changed it to UTF-8 and now it works. (note the cacheversion.text is in UTF-8 coding) I dont know if that matters. But now when my cacheupdater loads the file i get a NumberFormatException error when trying to convert the string to an integer. The text document only has the characters 1.0 saved inside. I cannot understand why it wont work!</p>
<p>I get a 460 error when the document wont get hosted under ANSI coding. With UTF-8 coding it works fine on server just get the number format exception.</p>
<p>Please help me and request code for my cachedownloader/client/whatever you need and I will post it!</p>
<p>Your help is immensely appreciated!<br>
photos:</p>
<p><a href="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png</a><br>
<a href="https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png</a><br>
<a href="https://www.dropbox.com/s/6je0do4po0grume/222.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/6je0do4po0grume/222.png</a></p>
<p><img src="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" alt width="" height=""><br>
<img src="https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png" alt width="" height=""><br>
<img src="https://www.dropbox.com/s/6je0do4po0grume/222.png?dl=0" alt width="" height=""></p>
<p><span class="bbcode-b">UPDATE! - I put dl. in front of the file and now it downloads the .text file but since its not ANSI coding its getting a string like $;'1.0 or something like that instead of just 1.0. Does anyone have a host site that works just like dropbox where you can make it DIRECTLY download without clicking a button because dropbox gives me a 460 error if the documents in ANSI coding? Which is default?</span></p>
<p>updatecache.java file -</p>
<p>[code]import java.net.URL;<br>
import java.net.URLConnection;<br>
import java.util.zip.<em>;<br>
import sign.signlink;<br>
import <a href="http://java.io" rel="nofollow noopener">java.io</a>.</em>;<br>
import javax.swing.JOptionPane;</p>
<p>public class UpdateCache implements Runnable {</p>
<pre><code>    public static final String ZIP_URL = "https://www.dropbox.com/s/hsnkfyohgofpbrv/------------.zip";
    public static final String VERSION_URL = "https://www.dropbox.com/s/zoexsmc6ddgsa0j/cacheVersion.text";
    public static final String VERSION_FILE = sign.signlink.findcachedir()+"cacheVersion.dat";
    private client client;
    client frame;
public UpdateCache(client client) {
            this.client = client;
}
            
private void drawLoadingText(int amount, String text) {
            client.drawLoadingText(amount, text);
}
    
    public double getCurrentVersion(){
            try {
                    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(VERSION_FILE)));
                    return Double.parseDouble(br.readLine());
            } catch (Exception e) {
                    return 0.1;
            }
    }
    
    public double getNewestVersion(){
            try {
                    URL tmp = new URL(VERSION_URL);
                    BufferedReader br = new BufferedReader(new InputStreamReader(tmp.openStream()));
                    return Double.parseDouble(br.readLine());
            } catch (Exception e) {
                    handleException(e);
                    return -1;
            }
    }
    
    private void handleException(Exception e){
            StringBuilder strBuff = new StringBuilder();
            strBuff.append("Please Screenshot this message, and send it to an admin!\r\n\r\n");
    StringBuilder append = strBuff.append(e.getClass().getName()).append(" \"").append(e.getMessage()).append("\"\r\n");
            for(StackTraceElement s : e.getStackTrace())
                    strBuff.append(s.toString()).append("\r\n");
            alert("Exception [" + e.getClass().getSimpleName() + "]",strBuff.toString(),true);
    }
    
    private void alert(String msg){
            alert("Message",msg,false);
    }
    
    private void alert(String title,String msg,boolean error){
            JOptionPane.showMessageDialog(null,
                       msg,
                       title,
                        (error ? JOptionPane.ERROR_MESSAGE : JOptionPane.PLAIN_MESSAGE));
    }
    
    @Override
    public void run() {
    drawLoadingText(0, "Checking Versions");
            try{
            double newest = getNewestVersion();
            if(newest &gt; this.getCurrentVersion()){
                    int n = JOptionPane.showConfirmDialog(
                                null,
                                "There is an update to version " + newest + "\n" +
                                    "Would you like to update?",
                                "Current version: "+ getCurrentVersion(),
                                JOptionPane.YES_NO_OPTION);
                    if(n == 0){
                            updateClient();
                            drawLoadingText(0, "Cache has been updated, please restart the client!");
                            alert("Cache has been updated, please restart the client!");
                            OutputStream out = new FileOutputStream(VERSION_FILE);
                            out.write(String.valueOf(newest).getBytes());;
                            System.exit(0);
                    }else{
                            alert(" Your client may not load correct " +
                            getCurrentVersion());
                            //System.exit(0);
                    }
            }
            }catch(Exception e){
                    handleException(e);
            }
    }
    
    private void updateClient() {
            File clientZip = downloadClient();
            if(clientZip != null){
            unZip(clientZip);
            }
    }
    
    private void unZip(File clientZip) {
            try {
                    unZipFile(clientZip,new File(sign.signlink.findcachedir()));
                    clientZip.delete();
            } catch (IOException e) {
                    handleException(e);
            }
    }
    
    private void unZipFile(File zipFile,File outFile) throws IOException{
            ZipInputStream zin = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
            ZipEntry e;
            long max = 0;
            long curr = 0;
            while((e = zin.getNextEntry()) != null)
                    max += e.getSize();
            zin.close();
            ZipInputStream in = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
            while((e = in.getNextEntry()) != null){
                    if(e.isDirectory())
                            new File(outFile,e.getName()).mkdirs();
                    else{
                            FileOutputStream out = new FileOutputStream(new File(outFile,e.getName()));
                            byte[] b = new byte[1024];
                            int len;
                            while((len = in.read(b,0,b.length)) &gt; -1){
                                    curr += len;
                                            out.write(b, 0, len);
                                            setUnzipPercent((int)((curr * 100) / max));
                            }
                            out.flush();
                            out.close();
                    }
            }
    }

    public int percent = 0;
    
    public void setDownloadPercent(int amount){
            percent = amount;
                    drawLoadingText(amount, "Downloading Cache" + " - " + amount + "%");
    }
    
    public int percent2 = 0;
    
    public void setUnzipPercent(int amount2){
            percent2 = amount2;
                    drawLoadingText(amount2, "Extracting Cache" + " - " + amount2 + "%");
    }

    private File downloadClient(){
            File ret = new File(signlink.findcachedir()+"cache.zip");
            try{
            OutputStream out = new FileOutputStream(ret);
            URLConnection conn = new URL(ZIP_URL).openConnection();
            InputStream in = conn.getInputStream();
            long max = conn.getContentLength();
            long curr = 0;
            byte[] b = new byte[1024];
            int len;
            while((len = in.read(b, 0, b.length)) &gt; -1){
                    out.write(b,0,len);
                    curr += len;
                    setDownloadPercent((int)((curr * 100) / max));
            }
            out.flush();
            out.close();
            in.close();
            return ret;
            }catch(Exception e){
                    handleException(e);
                            ret.delete();
                    return null;
            }
    }
</code></pre>
<p>}<br>
[/code]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877/1</link>
        <pubDate>Sat, 20 Sep 2014 19:16:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-546877-1</guid>
        <source url="https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877.rss">NumberFormatException cache updater Please Help!</source>
      </item>
  </channel>
</rss>
